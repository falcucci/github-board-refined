{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/features/issues/modal.js"],"names":["settings","settingsObject","chrome","storage","sync","get","items","$","each","key","value","jQuery","parseJSON","cardClasses","urlBase","cardCommandsSelector","cardModal","wasDoubleClicked","currentHash","gitHubCommand","createBranchCommand","getCardInformation","url","isIssue","card","ajax","done","result","empty","content","find","css","length","localStorage","setItem","html","getItem","remove","attr","append","appendTo","appendBranchName","appendGitHubCommand","modal","getBranchNamePrefix","suggestedName","name","text","toLowerCase","forEach","item","orig","sugg","getOriginalAuthor","window","location","pathname","split","getGitHubCommand","replace","getTicketNumber","getBranchName","urlHasHash","hash","getUrlHash","branchName","triggerCard","withCardId","withTicketId","trigger","setTimeout","removeHash","history","pushState","document","title","search","ready","body","on","event","preventDefault","urlParts","ticketId","href"],"mappings":"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","file":"modal.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/features/issues/modal.js\");\n","var settings = [\n  'gitlo.suggest-label-branch-type-active',\n  'gitlo.suggested-labels',\n  'gitlo.hub-command-active',\n  'gitlo.hub-command-default-branch',\n  'gitlo.max-branch-name-length'\n];\n\n\nvar settingsObject = {\n  'gitlo.suggest-label-branch-type-active': true,\n  'gitlo.suggested-labels': [\n    {\n      \"orig\": \"feature\",\n      \"sugg\": \"feature\"\n    },\n    {\n      \"orig\": \"enhancement\",\n      \"sugg\": \"enhancement\"\n    },\n    {\n      \"orig\": \"bug\",\n      \"sugg\": \"bug\"\n    },\n    {\n      \"orig\": \"chore\",\n      \"sugg\": \"chore\"\n    },\n    {\n      \"orig\": \"hotfix\",\n      \"sugg\": \"hotfix\"\n    }\n  ],\n  'gitlo.hub-command-active': true,\n  'gitlo.hub-command-default-branch': 'hml',\n  'gitlo.max-branch-name-length': 50\n};\n\n\nchrome.storage.sync.get(settings, function(items){\n\n\n  $.each(items, function(key, value){\n    if(typeof value !== 'undefined') {\n      if(key == 'gitlo.suggested-labels'){\n        settingsObject[key] = jQuery.parseJSON(value);\n      } else {\n        settingsObject[key] = value;\n      }\n    }\n  });\n\n\n});\n\n\nvar cardClasses = \"a[class^='h5 d-block lh-condensed mb-1 mr-5']\";\nvar urlBase = \"https://github.com\";\n\n\nvar cardCommandsSelector = '#partial-discussion-header';\n\n\nvar cardModal = '<div class=\"modal\" style=\"display: none\"></div>';\nvar wasDoubleClicked = false;\nvar currentHash = false;\nvar gitHubCommand = \"hub pull-request -i [ticketId] -b [ORIGINAL_AUTHOR]:[ORIGINAL_AUTHOR_BRANCH] -h [FROM_USER]:[FROM_BRANCH]\";\nvar createBranchCommand = 'git checkout -b ';\n\n\nfunction getCardInformation(url, isIssue) {\n  var card = $('.modal');\n  $.ajax(urlBase+ url).done(function(result){\n    if(wasDoubleClicked) return false;\n    card.empty();\n    var content = $(result).find(\"[type='text/css'], .issues-listing\");\n    var css = false;\n    if($(result).find(\"[type='text/css']\").length > 0) {\n      localStorage.setItem('gitlo.cardCSS', $(result).find(\"[type='text/css']\").html());\n    } else {\n      css = localStorage.getItem('gitlo.cardCSS');\n    }\n\n\n\n\n    content.find(\".tabnav\").remove();\n    content.find(\".discussion-timeline\").attr('style', 'width:70% !important;');\n    content.find(\".discussion-sidebar\").attr('style', 'width:25% !important;');\n    if(css !== false && css !== null) {\n      card.append('<style type=\"text/css\" >'+css+'</style>');\n    }\n    content.appendTo(card);\n    if(settingsObject['gitlo.suggest-label-branch-type-active']) {\n      appendBranchName();\n    }\n\n\n    if(settingsObject['gitlo.hub-command-active']) {\n      appendGitHubCommand();\n    }\n\n\n    card.modal();\n  });\n}\n\n\nfunction getBranchNamePrefix() {\n  var suggestedName = '';\n  if(settingsObject['gitlo.suggest-label-branch-type-active']) {\n    $('.labels').find('a').each(function () {\n      var name = $(this).text().toLowerCase();\n      settingsObject['gitlo.suggested-labels'].forEach(function (item) {\n        if (item.orig === name) {\n          suggestedName = item.sugg;\n        }\n      });\n    });\n    return suggestedName + '/';\n  }\n  return suggestedName;\n}\n\n\nfunction getOriginalAuthor() {\n  return window.location.pathname.split('/')[2];\n}\n\n\nfunction getGitHubCommand() {\n  return '<dl class=\"form-group\"><p></strong><input class=\"form-control\" style=\"width: 37%\" type=\"text\" value=\"'\n    + gitHubCommand.\n    replace('[ticketId]', getTicketNumber()).\n    replace('[ORIGINAL_AUTHOR]', getOriginalAuthor()).\n    replace('[ORIGINAL_AUTHOR_BRANCH]', settingsObject['gitlo.hub-command-default-branch']).\n    replace('[FROM_USER]', getOriginalAuthor()).\n    replace('[FROM_BRANCH]', getBranchNamePrefix()+ getBranchName())\n    + '\"></p></dl>';\n}\n\n\nfunction appendGitHubCommand() {\n  $(getGitHubCommand()).appendTo(cardCommandsSelector);\n}\n\n\nfunction urlHasHash() {\n  return (window.location.hash)?true:false;\n}\n\n\nfunction getUrlHash() {\n  return window.location.hash;\n}\n\n\nfunction getTicketNumber() {\n  return getUrlHash().replace('#', '');\n}\n\n\nfunction getBranchName() {\n  if(urlHasHash())\n    return 'issue-' + getTicketNumber();\n  else\n    return false;\n}\n\n\nfunction appendBranchName() {\n  var branchName = '<dl class=\"form-group\"><p><input class=\"form-control\" style=\"width: 18%; float: left;\" type=\"text\" value=\"' + createBranchCommand + getBranchNamePrefix() + getBranchName() + '\"></p></dl>';\n  if(branchName !== false) {\n    $(branchName).appendTo(cardCommandsSelector);\n  }\n}\n\n\nfunction triggerCard() {\n  var withCardId = $(\"div[id='\"+getTicketNumber()+\"'] > h5 > a\");\n  var withTicketId = $(\"a[href$='\"+getTicketNumber()+\"']\");\n\n\n  if(withTicketId.length > 0 || withCardId.length > 0) {\n    withCardId.trigger('click');\n    withTicketId.trigger('click');\n  } else {\n    setTimeout(triggerCard, 100);\n  }\n}\n\n\nfunction removeHash () {\n  history.pushState(\"\", document.title, window.location.pathname + window.location.search);\n}\n\n$(document).ready(function(){\n  $(cardModal).appendTo('body');\n  var body = $('body');\n  body.on('click', cardClasses, function(event){\n    event.preventDefault();\n    var url = $(this).attr('href');\n    var urlParts = url.split('/');\n    var isIssue = urlParts[urlParts.length - 2] === 'issues';\n    var ticketId = urlParts[urlParts.length - 1];\n    window.location.href = '#'+ticketId;\n    currentHash = getUrlHash();\n\n\n    if (isIssue) {\n      getCardInformation(url);\n    }\n  });\n  body.on('dblclick', cardClasses, function(event){\n    wasDoubleClicked = true;\n    event.preventDefault();\n    window.location.href = $(this).attr('href');\n  });\n\n\n  body.on('click', '.close-modal', function(){\n    removeHash();\n  });\n  if(urlHasHash()) {\n    triggerCard();\n  }\n\n\n  $(window).on('hashchange', function() {\n    if(currentHash !== false && currentHash !== window.location.hash) {\n      triggerCard();\n    }\n  });\n});\n"],"sourceRoot":""}